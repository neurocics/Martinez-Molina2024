model {   # NOTMS

Q[1]=0.25
seq[1]=0

for (c in 2:nT) { # All Trials  GO with RT

m[c] = NGO[c] # ifelse(Dseq_n[c]<=Dseq_n[c-1],1,0)
Q[c] =  (1-T1[c])*(Q[c-1] +  LR[idSub[c]] *(m[c] - Q[c-1]))   +  (T1[c])*Q[1]  # for faster test LR[idSub[c]]  = 0.14
seq[c] = 1-((1-Q[c])^(Dseq_n[c]-1)) # espectative  

}

for (n in Tng) {
		pr_ng[n] <- 1 / (1 + exp(-(W_inhb[idSub[n]] + W_inh[idSub[n]]*y[n-1] #
		                           ))) # 
		error[n] ~ dbern(pr_ng[n])
}


for (i in Trt) { # Trials  GO with RT
Drt[i] ~ dnorm(y[i], 1/sigma^2) 

y[i] = W_rtb[idSub[i]] + CC[i]  

CC [i] <-    #
        beta1[idSub[i]]*seq[i] + 
        beta2[idSub[i]]*Uno[i]*pError[i] + # pErrorNG 
		   #beta3[idSub[i]]*Uno[i] +           # priemro 
		    beta4[idSub[i]]*pError[i]         # pErrorG+pErrorNG  
        #beta5[idSub[i]]*Q[i]               # pErrorG+pErrorNG  
	}

for (S in 1:Nsubj){ # Subject 


beta1[S] ~ dnorm(mubeta1, 1/sigmabeta1^2)
beta2[S] ~ dnorm(mubeta2, 1/sigmabeta2^2)
beta3[S] ~ dnorm(mubeta3, 1/sigmabeta3^2)
beta4[S] ~ dnorm(mubeta4, 1/sigmabeta4^2)
beta5[S] ~ dnorm(mubeta5, 1/sigmabeta5^2)

#W_rt[S] ~ dnorm(muW_rt, 1/sigmaW_rt^2)
W_inh[S] ~ dnorm(muW_inh, 1/sigmaW_inh^2)
#W_acg[S] ~ dnorm(muW_acg, 1/sigmaW_acg^2)

W_rtb[S] ~ dnorm(muW_rtb, 1/sigmaW_rtb^2)
W_inhb[S] ~ dnorm(muW_inhb, 1/sigmaW_inhb^2)


LR[S] ~ dbeta(a.LR,b.LR)T(0.001 , 0.999)

}

	# priors

mubeta1 ~ dnorm(0,0.001)       #
sigmabeta1 ~ dunif(0.001,10)  

mubeta2 ~ dnorm(0,0.001)       #
sigmabeta2 ~ dunif(0.001,10) 

mubeta3 ~ dnorm(0,0.001)       #
sigmabeta3 ~ dunif(0.001,10) 

mubeta4 ~ dnorm(0,0.001)       #
sigmabeta4 ~ dunif(0.001,10) 

mubeta5 ~ dnorm(0,0.001)       #
sigmabeta5 ~ dunif(0.001,10) 

muW_rt ~ dnorm(0,0.001)      # 
sigmaW_rt~ dunif(0.001,10)

muW_inh ~ dnorm(0,0.001)      # 
sigmaW_inh~ dunif(0.001,10)

#muW_acg ~ dnorm(0,0.001)      # 
#sigmaW_acg~ dunif(0.001,10)

muW_rtb ~ dnorm(0,0.001)      # 
sigmaW_rtb~ dunif(0.001,10)

muW_inhb ~ dnorm(0,0.001)      # 
sigmaW_inhb~ dunif(0.001,10)

#muW_acgb ~ dnorm(0,0.001)      # 
#sigmaW_acgb~ dunif(0.001,10)


sigma ~ dunif(0.001, 10) # prior for the standard deviation 

mu.LR ~ dunif(0.05,0.15) #dbeta(1,1) #dbeta(1,1) #
k.LR~  dunif(0.001,10)

a.LR <- mu.LR * k.LR
b.LR <- (1-mu.LR) * k.LR
}
